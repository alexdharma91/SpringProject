<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:context="http://www.springframework.org/schema/context"
             xmlns:s="http://www.springframework.org/schema/security"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:sec="http://www.springframework.org/schema/security"
             xsi:schemaLocation=
      "http://www.springframework.org/schema/context
      http://www.springframework.org/schema/context/spring-context-3.0.xsd
      http://www.springframework.org/schema/security
      http://www.springframework.org/schema/security/spring-security-3.1.xsd
      http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <context:component-scan base-package="com"/>

    <s:http use-expressions="true" auto-config="true" authentication-manager-ref="springAuthenticationProviderInst">
        <s:form-login
                login-page="/log/in"
                default-target-url="/welcome"
                authentication-failure-url="/login?error"
                username-parameter="username"
                password-parameter="password"/>

        <s:logout logout-success-url="/login?logout"/>

        <s:intercept-url pattern="/absence/*" access="hasRole('ROLE_USER')" />
        <s:intercept-url pattern="/employee/*" access="hasRole('ROLE_USER')" />
        <s:intercept-url pattern="/payout/*" access="hasRole('ROLE_USER')" />

        <s:intercept-url pattern="/index" access="isAuthenticated()" />

        <s:intercept-url pattern="/log/*" access="permitAll" />

        <!-- enable csrf protection -->
        <!--  <csrf/>-->
    </s:http>

    <s:authentication-manager id="springAuthenticationProviderInst">
        <s:authentication-provider ref="springAuthenticationProvider"/>
    </s:authentication-manager>

    <beans:bean id="encoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>

</beans:beans>